<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add item: {{dbtable}}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>
<body>

    <h1 class="header">Ajouter Nouveau NEEEDSS TRANSLATION!!!</h1>
    <a href="{{url_for('dashboard')}}">ü†ê BACK</a>
    
    {%with messages = get_flashed_messages() %}
    {%if messages %}
    {%for message in messages %}
     {{message}}
    {%endfor%}
    {%endif%}
{%endwith%} 
    <div class="items">
 

    <div >
        <button type="button" class="collapsible">+ Ajouter Nouveau</button>
        <div class="content"> 
        {% for form in forms %}
      
        <div >
            {%set form_id=loop.index0%}
    <form method="POST" action="" id="{{form_id}}">
        <tr>
        {% for field in form %}
       
            {%if  field.label.text != 'Submit' and field.label.text != "CSRF Token" %}{{ field.label }}{%else%}{%endif%} {% if field.flags.required %}*{% endif %}<br>
            {{ field(form=form_id) }}<br><br>
            
        
        {% endfor %}
        <br><br>
    </tr>
    </form>
</div>

{%endfor%}
</div>
{%if searchform%}
<form method="POST" action="" id="searchformid">
{{searchform.searchstring}}
{{searchform.searchfilter}}
{{searchform.searchsubmit}}

{{searchform.hidden_tag()}}
</form>
{%endif%}
{%if table|length !=0%}
        <table class="fl-table" border="1">
      <thead>
            <tr>
            {%for title in headers%}
            <th>{{title}}</th>
            {%endfor%}
        </tr>
        
    </thead>
        {% for value in table %}
        <tr>
        {%for item in value%}
            <td>
        {{item}}
    </td>
        {%endfor%}
        {%if user_role == 'admin'%}
        <td><a href="{{url_for('edit_entry',tbl=dbtable,id=value[0])}}">√âditer</a></td>
        <td><a href="{{url_for('delete_entry',tbl=dbtable,tblid=dbtableid,id=value[0])}}">Effacer</a></td>
        {%endif%}
        </tr>
        {% endfor %}
    </table>
    
    
    {%endif%}
    </div>

</div>
</div>

<div>
    {%if hasDynamicSelector == True and dbtable == 'fraismateriel'%}
    <script>
        let fraismaterieltype_select = document.getElementById('fraismaterieltype');
        let fraismaterielname_select = document.getElementById('fraismaterielnom');
    
        fraismaterieltype_select.onclick = function(){
            fraismaterieltype = fraismaterieltype_select.value;
    
            fetch('/fraismaterielname/'+fraismaterieltype).then(function(response){
                response.json().then(function(data){
                    let optionHTML='';
                    
                    optionHTML+= "<option value='addnew'>Ajouter nouveau ?</option>";
                    for (let fraismateriel of data.fraismaterielnames){
                        optionHTML+= '<option value="'+fraismateriel.name+'">'+fraismateriel.name+'</option>';
                    }
                    
                    fraismaterielname_select.innerHTML=optionHTML;
                });
            });
        }
    </script>
    {%endif%}

    {%if hasDynamicSelector == True and dbtable == 'payment'%}
<script>
    let paymenttype_select = document.getElementById('paiementsType');
    let paymentname_select = document.getElementById('paiementsNom');

    paymenttype_select.onclick = function(){
        paymenttype = paymenttype_select.value;

        fetch('/paymentnames/'+paymenttype).then(function(response){
            response.json().then(function(data){
                let optionHTML='';
                
                optionHTML+= "<option value='addnew'>Ajouter nouveau ?</option>";
                for (let paymentname of data.paymentnames){
                    optionHTML+= '<option value="'+paymentname.name+'">'+paymentname.name+'</option>';
                }
                
                paymentname_select.innerHTML=optionHTML;
            });
        });
    }
</script>
{%endif%}
{%if hasDynamicSelector == True and dbtable == 'facturation'%}
<script>
    let facturationtype_select = document.getElementById('facturationType');
    let facturationname_select = document.getElementById('facturationNom');

    facturationtype_select.onclick = function(){
        facturationtype = facturationtype_select.value;

        fetch('/facturationnames/'+facturationtype).then(function(response){
            response.json().then(function(data){
                let optionHTML='';
                
                optionHTML+= "<option value='addnew'>Ajouter nouveau ?</option>";
                for (let facturationname of data.facturationnames){
                    optionHTML+= '<option value="'+facturationname.name+'">'+facturationname.name+'</option>';
                }
                
                facturationname_select.innerHTML=optionHTML;
            });
        });
    }
</script>
{%endif%}
{%if hasDynamicSelector == True and dbtable == 'dentisterie'%}
<script>
    let dentisterietype_select = document.getElementById('dentisterieType');
    let dentisteriename_select = document.getElementById('dentisterieNom');

    dentisterietype_select.onclick = function(){
        dentisterietype = dentisterietype_select.value;

        fetch('/dentisterienames/'+dentisterietype).then(function(response){
            response.json().then(function(data){
                let optionHTML='';
                
                optionHTML+= "<option value='addnew'>Ajouter nouveau ?</option>";
                for (let dentisteriename of data.dentisterienames){
                    optionHTML+= '<option value="'+dentisteriename.name+'">'+dentisteriename.name+'</option>';
                }
                
                dentisteriename_select.innerHTML=optionHTML;
            });
        });
    }
</script>
{%endif%}


<script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "block") {
      content.style.display = "none";
    } else {
      content.style.display = "block";
    }
  });
} 
</script>
<style>
    .content {
      padding: 0 18px;
      background-color: white;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.2s ease-out;
    }
    </style>
    
    <script>
    var coll = document.getElementsByClassName("collapsible");
    var i;
    
    for (i = 0; i < coll.length; i++) {
      coll[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.maxHeight){
          content.style.maxHeight = null;
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
        }
      });
    }
    </script>
</body>
</html>